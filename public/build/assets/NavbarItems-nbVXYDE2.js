import{r as i,j as e,a as Y,f as $}from"./app-CiDaUcey.js";import{y as b,P as Q}from"./PortalLayout-CxqdbcvG.js";import{a as z,b as W,c as X,d as Z}from"./index-B_aCOuSP.js";import{S as I}from"./sweetalert2.esm.all-89IKscqO.js";import{C as ee,x as E}from"./useData-CInDpAgI.js";import{u as se}from"./useErrorToast-CTAe8NjK.js";import{M as B}from"./Modal-CviNt8xm.js";import{F as c}from"./Form-DY59OgGH.js";import{R as K}from"./Row-DoEZsrd7.js";import{C as f}from"./Col-H7LL1jeG.js";import{u as w,c as A,B as y}from"./warning-CDyBO85i.js";import{C as O}from"./Card-O6qekqvm.js";import{u as ae}from"./CloseButton-uf0rwOsm.js";import{B as R}from"./Badge-B8SxXTMH.js";import{B as P}from"./ButtonGroup-Bf8VZ0Fe.js";import{T as te}from"./Table-CC8sxR3u.js";import"./ElementChildren-Ykn35dyp.js";function H(s,t){return Array.isArray(s)?s.includes(t):s===t}const _=i.createContext({});_.displayName="AccordionContext";const F=i.forwardRef(({as:s="div",bsPrefix:t,className:n,children:d,eventKey:m,...r},o)=>{const{activeEventKey:l}=i.useContext(_);return t=w(t,"accordion-collapse"),e.jsx(ee,{ref:o,in:H(l,m),...r,className:A(n,t),children:e.jsx(s,{children:i.Children.only(d)})})});F.displayName="AccordionCollapse";const M=i.createContext({eventKey:""});M.displayName="AccordionItemContext";const U=i.forwardRef(({as:s="div",bsPrefix:t,className:n,onEnter:d,onEntering:m,onEntered:r,onExit:o,onExiting:l,onExited:x,...N},p)=>{t=w(t,"accordion-body");const{eventKey:a}=i.useContext(M);return e.jsx(F,{eventKey:a,onEnter:d,onEntering:m,onEntered:r,onExit:o,onExiting:l,onExited:x,children:e.jsx(s,{ref:p,...N,className:A(n,t)})})});U.displayName="AccordionBody";function ne(s,t){const{activeEventKey:n,onSelect:d,alwaysOpen:m}=i.useContext(_);return r=>{let o=s===n?null:s;m&&(Array.isArray(n)?n.includes(s)?o=n.filter(l=>l!==s):o=[...n,s]:o=[s]),d==null||d(o,r),t==null||t(r)}}const G=i.forwardRef(({as:s="button",bsPrefix:t,className:n,onClick:d,...m},r)=>{t=w(t,"accordion-button");const{eventKey:o}=i.useContext(M),l=ne(o,d),{activeEventKey:x}=i.useContext(_);return s==="button"&&(m.type="button"),e.jsx(s,{ref:r,onClick:l,...m,"aria-expanded":Array.isArray(x)?x.includes(o):o===x,className:A(n,t,!H(x,o)&&"collapsed")})});G.displayName="AccordionButton";const q=i.forwardRef(({as:s="h2","aria-controls":t,bsPrefix:n,className:d,children:m,onClick:r,...o},l)=>(n=w(n,"accordion-header"),e.jsx(s,{ref:l,...o,className:A(d,n),children:e.jsx(G,{onClick:r,"aria-controls":t,children:m})})));q.displayName="AccordionHeader";const J=i.forwardRef(({as:s="div",bsPrefix:t,className:n,eventKey:d,...m},r)=>{t=w(t,"accordion-item");const o=i.useMemo(()=>({eventKey:d}),[d]);return e.jsx(M.Provider,{value:o,children:e.jsx(s,{ref:r,...m,className:A(n,t)})})});J.displayName="AccordionItem";const V=i.forwardRef((s,t)=>{const{as:n="div",activeKey:d,bsPrefix:m,className:r,onSelect:o,flush:l,alwaysOpen:x,...N}=ae(s,{activeKey:"onSelect"}),p=w(m,"accordion"),a=i.useMemo(()=>({activeEventKey:d,onSelect:o,alwaysOpen:x}),[d,o,x]);return e.jsx(_.Provider,{value:a,children:e.jsx(n,{ref:t,...N,className:A(r,p,l&&`${p}-flush`)})})});V.displayName="Accordion";const L=Object.assign(V,{Button:G,Collapse:F,Item:J,Header:q,Body:U}),D=(s=null)=>({parent_id:(s==null?void 0:s.parent_id)??"",icon:(s==null?void 0:s.icon)??"",label:(s==null?void 0:s.label)??"",path:(s==null?void 0:s.path)??"",route_name:(s==null?void 0:s.route_name)??"",route_parameters:JSON.stringify((s==null?void 0:s.route_parameters)??{}),order:(s==null?void 0:s.order)??0,is_active:(s==null?void 0:s.is_active)??!0});function re({show:s,onHide:t,item:n=null,navbarId:d,onSuccess:m}){const r=!!n,{showErrorToast:o}=se(),[l,x]=i.useState(D()),[N,p]=i.useState([]);i.useEffect(()=>{if(!s)return;(async()=>{try{const h=await E.get(route("admin.navbar-items.parents",{navbar:d}));p(h.data||[])}catch{p([])}})()},[s,d]),i.useEffect(()=>{s&&x(D(r?n:null))},[s,r,n]);const a=({target:j})=>{const{name:h,value:u,type:C,checked:k}=j;x(S=>({...S,[h]:C==="checkbox"?k:u}))},g=async j=>{var u,C;j.preventDefault();const h=r?"Update":"Create";try{if(!(await I.fire({title:`${h} Navbar Item`,text:`Confirm to ${h.toLowerCase()} this navbar item.`,icon:"question",showCancelButton:!0,confirmButtonText:"Yes",cancelButtonText:"Cancel",reverseButtons:!0})).isConfirmed)return;I.fire({title:"Please wait...",text:`${h} in progress`,icon:"info",allowOutsideClick:!1,allowEscapeKey:!1,didOpen:()=>I.showLoading()});const S={...l,navbar_id:d},T=r?route("admin.navbar-items.update",n.id):route("admin.navbar-items.store"),v=r?await E.put(T,S):await E.post(T,S);((u=v==null?void 0:v.data)==null?void 0:u.success)!==!1&&(b.success(((C=v==null?void 0:v.data)==null?void 0:C.message)||`Item ${h.toLowerCase()}d successfully`),m==null||m(),t())}catch(k){o(k)}finally{I.close()}};return e.jsx(B,{show:s,onHide:t,size:"lg",centered:!0,children:e.jsxs(c,{onSubmit:g,children:[e.jsx(B.Header,{closeButton:!0,children:e.jsx(B.Title,{children:r?"Edit Navbar Item":"New Navbar Item"})}),e.jsx(B.Body,{children:e.jsxs(K,{children:[e.jsx(f,{md:6,children:e.jsxs(c.Group,{className:"mb-3",children:[e.jsx(c.Label,{children:"Parent Item"}),e.jsxs(c.Select,{name:"parent_id",value:l.parent_id,onChange:a,children:[e.jsx("option",{value:"",children:"-- None --"}),N.map(j=>e.jsx("option",{value:j.id,children:j.label},j.id))]})]})}),e.jsx(f,{md:6,children:e.jsxs(c.Group,{className:"mb-3",children:[e.jsx(c.Label,{children:"Label"}),e.jsx(c.Control,{name:"label",value:l.label,onChange:a,required:!0})]})}),e.jsx(f,{md:6,children:e.jsxs(c.Group,{className:"mb-3",children:[e.jsx(c.Label,{children:"Icon (class)"}),e.jsx(c.Control,{name:"icon",value:l.icon,onChange:a,placeholder:"e.g. bi bi-house"})]})}),e.jsx(f,{md:6,children:e.jsxs(c.Group,{className:"mb-3",children:[e.jsx(c.Label,{children:"Path"}),e.jsx(c.Control,{name:"path",value:l.path,onChange:a,placeholder:"/dashboard"})]})}),e.jsx(f,{md:6,children:e.jsxs(c.Group,{className:"mb-3",children:[e.jsx(c.Label,{children:"Route Name"}),e.jsx(c.Control,{name:"route_name",value:l.route_name,onChange:a})]})}),e.jsx(f,{md:6,children:e.jsxs(c.Group,{className:"mb-3",children:[e.jsx(c.Label,{children:"Route Parameters (JSON)"}),e.jsx(c.Control,{as:"textarea",name:"route_parameters",value:l.route_parameters,onChange:a,placeholder:'{"id":1}'})]})}),e.jsx(f,{md:6,children:e.jsxs(c.Group,{className:"mb-3",children:[e.jsx(c.Label,{children:"Order"}),e.jsx(c.Control,{type:"number",name:"order",value:l.order,onChange:a})]})}),e.jsx(f,{md:6,children:e.jsx(c.Group,{className:"mt-4",children:e.jsx(c.Check,{type:"checkbox",label:"Active",name:"is_active",checked:l.is_active,onChange:a})})})]})}),e.jsxs(B.Footer,{children:[e.jsx(y,{variant:"secondary",onClick:t,children:"Cancel"}),e.jsx(y,{variant:"primary",type:"submit",children:r?"Update":"Save"})]})]})})}function be({navbar:s=null}){var p;const[t,n]=i.useState(!1),[d,m]=i.useState(null),r=()=>{m(null),n(!0)},o=()=>{n(!1),m(null)},l=i.useCallback(a=>{b.success(a),n(!1)},[]),x=async a=>{var g,j;try{const h=await E.get(route("admin.navbar-items.edit",a));h.data.success?(m(h.data.data),n(!0),$.reload()):b.error(h.data.message)}catch(h){b.error(((j=(g=h.response)==null?void 0:g.data)==null?void 0:j.message)||"Error loading item")}},N=async a=>{if((await I.fire({title:"Delete Item?",text:"This action cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed)try{await E.delete(route("admin.navbar-items.destroy",a)),b.success("Item has been deleted."),$.reload()}catch{b.error("Delete failed.")}};return e.jsxs(Q,{children:[e.jsx(Y,{title:`Managing ${(s==null?void 0:s.name)||"Navbar Items"}`}),e.jsx(K,{className:"mb-4",children:e.jsx(f,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mb-1",children:"Navigation Manager"}),e.jsxs("p",{className:"text-muted mb-0",children:["Managing:"," ",e.jsx("span",{className:"fw-semibold text-capitalize",children:s==null?void 0:s.name})]})]}),e.jsxs(y,{variant:"primary",className:"d-flex align-items-center",onClick:r,children:[e.jsx(z,{className:"me-2"}),"Add New Item"]})]})})}),e.jsx(O,{className:"border-0 shadow-sm navbar-items-management",children:e.jsx(O.Body,{className:"p-0",children:((p=s==null?void 0:s.items)==null?void 0:p.length)>0?e.jsx(L,{defaultActiveKey:"0",flush:!0,children:s.items.map((a,g)=>{var j,h;return e.jsxs(L.Item,{eventKey:g.toString(),children:[e.jsx(L.Header,{className:"",children:e.jsxs("div",{className:"d-flex align-items-center w-100",children:[a.icon&&e.jsx("i",{className:`${a.icon} me-3`}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("span",{className:"fw-medium",children:a.label}),a.path&&e.jsxs("small",{className:"text-muted ms-2",children:["(",a.path,")"]})]}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(R,{bg:a.is_active?"success":"danger",className:"me-2",children:a.is_active?"Active":"Inactive"}),((j=a.children)==null?void 0:j.length)>0&&e.jsxs(R,{bg:"light",text:"dark",className:"me-2",children:[a.children.length," ","sub-items"]}),e.jsxs(P,{className:"gap-2",children:[e.jsx(y,{variant:"outline-primary",size:"sm",onClick:u=>{u.stopPropagation(),x(a.id)},children:e.jsx(W,{size:14})}),e.jsx(y,{variant:"outline-danger",size:"sm",onClick:u=>{u.stopPropagation(),N(a.id)},children:e.jsx(X,{size:14})})]})]})]})}),e.jsx(L.Body,{className:"px-4 py-3 bg-light",children:((h=a.children)==null?void 0:h.length)>0?e.jsxs(te,{responsive:!0,borderless:!0,className:"mb-0",children:[e.jsx("thead",{className:"bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Label"}),e.jsx("th",{children:"Path"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:a.children.map((u,C)=>e.jsxs("tr",{className:"bg-white",children:[e.jsxs("td",{className:"align-middle",children:[u.icon&&e.jsx("i",{className:`${u.icon} me-2`}),u.label]}),e.jsx("td",{className:"align-middle",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("span",{className:"text-truncate",children:u.path}),u.path&&e.jsx(Z,{className:"ms-2",size:14})]})}),e.jsx("td",{children:e.jsx(R,{bg:u.is_active?"success":"danger",children:u.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"align-middle",children:e.jsxs(P,{className:"gap-2",size:"sm",children:[e.jsx(y,{variant:"outline-primary",onClick:()=>x(u.id),children:"Edit"}),e.jsx(y,{variant:"outline-danger",onClick:()=>N(u.id),children:"Delete"})]})})]},u.id||C))})]}):e.jsx("div",{className:"text-center py-4 text-muted",children:"No sub-items found for this navigation item"})})]},a.id||g)})}):e.jsxs("div",{className:"text-center py-5",children:[e.jsx(z,{size:48,className:"text-muted mb-3"}),e.jsx("h5",{className:"text-muted",children:"No navigation items yet"}),e.jsx("p",{className:"text-muted mb-4",children:"Get started by creating your first navigation item"}),e.jsx(y,{variant:"primary",onClick:r,children:"Create First Item"})]})})}),e.jsx(re,{show:t,onHide:o,item:d,navbarId:s==null?void 0:s.id,onSuccess:l})]})}export{be as default};
